"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}(function(root,factory){if(typeof define==="function"&&define.amd){define([],factory)}else if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=factory()}else{root.navigation=factory()}})(typeof self!=="undefined"?self:void 0,function(){'use strict';var navigation={};var settings;var defaults={breakpoint:960,main:null,nav:null,orientation:"vertical",position:0,minHeights:true};var navScrollState={position:0,top:0};var extendDefaults=function extendDefaults(defaults,options){var property;for(property in options){if(Object.prototype.hasOwnProperty.call(options,property)){defaults[property]=options[property]}}return defaults};var updateMenuToggle=function updateMenuToggle(){var menuToggle=settings.nav.querySelector(".menu-toggle");menuToggle.classList.add("js-menu-toggle");menuToggle.setAttribute("aria-expanded","false");menuToggle.setAttribute("aria-label","Open menu")};var getSubmenuToggle=function getSubmenuToggle(){var toggleButton=document.createElement("button");toggleButton.classList.add("submenu-toggle","js-submenu-toggle");toggleButton.setAttribute("aria-label","Open child menu");toggleButton.setAttribute("aria-expanded","false");return toggleButton};var addSubmenuToggles=function addSubmenuToggles(){var menu=settings.nav.querySelector("ul");var submenus=menu.querySelectorAll("ul");if(!submenus.length)return;var toggleButton=getSubmenuToggle();submenus.forEach(function(submenu){if(submenu.parentNode.querySelector(".js-submenu-toggle"))return;submenu.parentNode.insertBefore(toggleButton.cloneNode(true),submenu)});menu.classList.add("has-submenu-toggle","js-has-submenu-toggle")};var toggleMenu=function toggleMenu(target,expanded){var label="Open menu"===target.getAttribute("aria-label")?"Close menu":"Open menu";target.setAttribute("aria-expanded",expanded);target.setAttribute("aria-label",label);document.body.classList.toggle("menu-toggled-open");settings.nav.classList.toggle("toggled-open")};var toggleSubmenu=function toggleSubmenu(target,expanded){var label="Open child menu"===target.getAttribute("aria-label")?"Close child menu":"Open child menu";target.setAttribute("aria-expanded",expanded);target.setAttribute("aria-label",label);target.parentNode.classList.toggle("toggled-open");resizeHandler();positionNav()};var clickHandler=function clickHandler(event){var target=event.target;var expanded="false"===target.getAttribute("aria-expanded")?"true":"false";if(target.classList.contains("js-menu-toggle")){toggleMenu(target,expanded)}if(target.classList.contains("js-submenu-toggle")){toggleSubmenu(target,expanded)}};var resizeHandler=function resizeHandler(){if(!settings.breakpoint)return;if(settings.breakpoint>window.innerWidth){settings.main.style.minHeight="";settings.nav.style.minHeight=""}else{settings.nav.classList.remove("toggled-open");document.body.classList.remove("menu-toggled-open");var menuToggle=settings.nav.querySelector(".menu-toggle");if(menuToggle){menuToggle.setAttribute("aria-expanded","false");menuToggle.setAttribute("aria-label","Open menu")}if("vertical"===settings.orientation&&settings.minHeights){var navHeight=settings.nav.querySelector("ul").scrollHeight;var windowHeight=window.innerHeight;var minHeight=navHeight>windowHeight?navHeight+"px":windowHeight+"px";settings.main.style.minHeight=minHeight;settings.nav.style.minHeight=minHeight}}};var positionNav=function positionNav(){var windowTop=window.pageYOffset;var bottomedOut=window.innerHeight+windowTop>=document.body.offsetHeight;var scrollDiff=navScrollState.top-windowTop;var upperBound=(settings.nav.scrollHeight-window.innerHeight)*-1;var position=navScrollState.position;position=position+scrollDiff;if(settings.position<position){position=settings.position}if(position<upperBound||bottomedOut){position=upperBound}navScrollState.position=position;navScrollState.top=windowTop;settings.nav.style.top=position+"px"};var scrollHandler=function scrollHandler(){if((!settings.breakpoint||settings.breakpoint<window.innerWidth)&&settings.main.offsetHeight>settings.nav.scrollHeight&&window.innerHeight<settings.nav.scrollHeight+settings.position){requestAnimationFrame(positionNav)}};var focusHandler=function focusHandler(event){if("A"!==event.target.tagName)return;var item=event.target;while(!item.classList.contains("js-has-submenu-toggle")){if("LI"===item.tagName){if(item.classList.contains("focus")){item.classList.remove("focus")}else{item.classList.add("focus")}}item=item.parentElement}};navigation.destroy=function(){if(!settings)return;settings.nav.removeEventListener("click",clickHandler,false);if("vertical"===settings.orientation){window.addEventListener("resize",resizeHandler,true);window.removeEventListener("scroll",scrollHandler,true)}settings=null};navigation.init=function(options){if(!options.nav||!options.main)return;navigation.destroy();settings=extendDefaults(defaults,options||{});updateMenuToggle();addSubmenuToggles();resizeHandler();settings.nav.addEventListener("click",clickHandler,false);window.addEventListener("resize",resizeHandler,true);if("vertical"===settings.orientation){window.addEventListener("scroll",scrollHandler,true)}if("horizontal"===settings.orientation){settings.nav.addEventListener("focus",focusHandler,true);settings.nav.addEventListener("blur",focusHandler,true)}};return navigation});