"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}(function(root,factory){if(typeof define==="function"&&define.amd){define([],factory)}else if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=factory()}else{root.navigation=factory()}})(typeof self!=="undefined"?self:void 0,function(){'use strict';var navigation={};var settings;var defaults={breakpoint:null,main:null,nav:null,orientation:"vertical",position:0,minHeights:true};var navScrollState={position:0,top:0};var extendDefaults=function extendDefaults(defaults,options){var property;for(property in options){if(Object.prototype.hasOwnProperty.call(options,property)){defaults[property]=options[property]}}return defaults};var getDropdownButton=function getDropdownButton(){var dropdownButton=document.createElement("button");dropdownButton.classList.add("dropdown-toggle","js-dropdown-toggle");dropdownButton.setAttribute("aria-label","Expand child menu");dropdownButton.setAttribute("aria-expanded","false");return dropdownButton};var accessibleNav=function accessibleNav(){var menu=settings.nav.querySelector("ul");var submenus=menu.querySelectorAll("ul");if(!submenus.length)return;var dropdownButton=getDropdownButton();submenus.forEach(function(submenu){var parentMenuItem=submenu.parentNode;var dropdown=parentMenuItem.querySelector(".js-dropdown-toggle");if(!dropdown){var thisDropdownButton=dropdownButton.cloneNode(true);submenu.parentNode.insertBefore(thisDropdownButton,submenu)}});menu.classList.add("has-dropdown-toggle")};var toggleNav=function toggleNav(){var menuToggle=settings.nav.querySelector(".menu-toggle");if(!menuToggle)return;menuToggle.setAttribute("aria-expanded","false");menuToggle.setAttribute("aria-label","Open menu");menuToggle.addEventListener("click",function(){settings.nav.classList.toggle("toggled-on");var expanded="false"===menuToggle.getAttribute("aria-expanded")?"true":"false";var label="Open menu"===menuToggle.getAttribute("aria-label")?"Close menu":"Open menu";menuToggle.setAttribute("aria-expanded",expanded);menuToggle.setAttribute("aria-label",label);document.body.classList.toggle("menu-toggled-on")},false)};var setMinHeight=function setMinHeight(){if(!settings.minHeights)return;if(settings.breakpoint&&settings.breakpoint>window.innerWidth){settings.nav.removeAttribute("style");return}var navHeight=settings.nav.querySelector("ul").scrollHeight;var windowHeight=window.innerHeight;var minHeight=navHeight>windowHeight?navHeight+"px":windowHeight+"px";settings.main.style.minHeight=minHeight;settings.nav.style.minHeight=minHeight};var toggleSection=function toggleSection(event){var target=event.target;if(!target.classList.contains("js-dropdown-toggle"))return;target.parentNode.classList.toggle("toggled-open");var expanded="false"===target.getAttribute("aria-expanded")?"true":"false";target.setAttribute("aria-expanded",expanded);setMinHeight();positionNav()};var positionNav=function positionNav(){var windowTop=window.pageYOffset;var bottomedOut=window.innerHeight+windowTop>=document.body.offsetHeight;var scrollDiff=navScrollState.top-windowTop;var upperBound=(settings.nav.scrollHeight-window.innerHeight)*-1;var position=navScrollState.position;position=position+scrollDiff;if(settings.position<position){position=settings.position}if(position<upperBound||bottomedOut){position=upperBound}navScrollState.position=position;navScrollState.top=windowTop;settings.nav.style.top=position+"px"};var scrollHandler=function scrollHandler(){if((!settings.breakpoint||settings.breakpoint<window.innerWidth)&&settings.main.offsetHeight>settings.nav.scrollHeight&&window.innerHeight<settings.nav.scrollHeight+settings.position){requestAnimationFrame(positionNav)}};navigation.destroy=function(){if(!settings)return;settings.element.removeEventListener("click",toggleSection,false);if("vertical"===settings.orientation){window.addEventListener("resize",setMinHeight,true);window.removeEventListener("scroll",positionNav,true)}settings=null};navigation.init=function(options){if(!options.nav||!options.main)return;navigation.destroy();settings=extendDefaults(defaults,options||{});accessibleNav();toggleNav();settings.nav.addEventListener("click",toggleSection,false);if("vertical"===settings.orientation){setMinHeight();window.addEventListener("resize",setMinHeight,true);window.addEventListener("scroll",scrollHandler,true)}};return navigation});